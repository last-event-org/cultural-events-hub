<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Créer un Événement</title>
    @vite(['resources/css/app.css', 'resources/js/hours_create_event.js'])

</head>

<body class="bg-gray-50">
    @include("pages/partials/header")
    <section class="bg-gray-50 flex items-center justify-center my-20">

        {{-- <div class="bg-white p-8 rounded shadow-md w-full max-w-3xl"> --}}
            <div class="bg-white p-8 rounded shadow-md w-full max-w-6xl">
                <h2 class="text-2xl font-bold mb-6 text-center text-gray-700">
                    Créer un Événement
                </h2>
                <form action={{ route('events.store') }} method="POST" class="space-y-4" enctype="multipart/form-data">

                    {{ csrfField() }}

                    {{-- {{ inspect(flashMessages.all()) }} --}}
                    @error('E_INVALID_CREDENTIALS')

                    {{ $message }}

                    @end

                    <section class="flex justify-around gap-10">
                        <div class="w-full">
                            <div class="block text-gray-800 text-xl font-semibold my-4 text-center">
                                Événement
                            </div>
                            <div class="text-sm">
                                <div class="flex flex-col mb-3">
                                    <label for="title" class="block text-gray-600">
                                        Titre
                                    </label>
                                    <input type="text" id="title" name="title" class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm
                       focus:ring-slate-500 focus:border-slate-700 sm:text-sm" value="{{old('title') || '' }}">
                                    @inputError('title')
                                    <div style="color: red;">{{ $messages.join(', ') }}</div>
                                    @end
                                </div>

                                <div class="flex flex-col mb-3">
                                    <label for="subtitle" class="block text-gray-600">
                                        Sous-Titre
                                    </label>
                                    <input type="text" id="subtitle" name="subtitle" class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm
                         focus:ring-slate-500 focus:border-slate-700 sm:text-sm" value="{{old('subtitle') || '' }}">
                                    @inputError('subtitle')
                                    <div style="color: red;">{{ $messages.join(', ') }}</div>
                                    @end
                                </div>

                                <div class="flex flex-col mb-3">
                                    <label for="description" class="block text-gray-600">
                                        Description
                                    </label>
                                    <textarea type="text" id="description" name="description"
                                        class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-slate-500 focus:border-slate-700 sm:text-sm">{{old('description') || '' }}</textarea>
                                    @inputError('description')
                                    <div style="color: red;">{{ $messages.join(', ') }}</div>
                                    @end
                                </div>
                            </div>

                            <div class="flex text-sm gap-2">
                                <div class="flex-1">
                                    <label for="event_start" class="block text-gray-600">
                                        Début
                                    </label>
                                    <input type="datetime-local" id="event_start" name="event_start"
                                        class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-slate-500 focus:border-slate-700 sm:text-sm"
                                        value="">
                                </div>

                                <div class="flex-1">
                                    <label for="event_end" class="block text-gray-600">
                                        Fin
                                    </label>
                                    <input type="datetime-local" id="event_end" name="event_end"
                                        class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-slate-500 focus:border-slate-700 sm:text-sm"
                                        value="">
                                </div>
                            </div>

                            @flashMessage('date')
                            <div style="color: red;">{{ $message.message }}</div>
                            @end
                        </div>

                        <div class="px-5 w-full bg-blue-50 rounded-lg">
                            <div class="block text-gray-800 text-xl font-semibold my-4 text-center">
                                Lieu
                            </div>
                            <div class="flex flex-col text-sm">
                                <div class="flex flex-col mb-3">
                                    <label for="name" class="block text-gray-600">
                                        Nom
                                    </label>
                                    <input type="text" id="name" name="name" class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm
                         focus:ring-slate-500 focus:border-slate-700 sm:text-sm" value="{{old('name') || '' }}">
                                    @inputError('name')
                                    <div style="color: red;">{{ $messages.join(', ') }}</div>
                                    @end
                                </div>

                                <div class="flex mb-3 gap-2">
                                    <div class="flex flex-col w-5/6">
                                        <label for="street" class="block text-gray-600">
                                            Rue
                                        </label>
                                        <input type="text" id="street" name="street" class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm
                             focus:ring-slate-500 focus:border-slate-700 sm:text-sm" value="{{old('street') || '' }}">
                                        @inputError('street')
                                        <div style="color: red;">{{ $messages.join(', ') }}</div>
                                        @end
                                    </div>

                                    <div class="flex flex-col w-1/6">
                                        <label for="number" class="block text-gray-600">
                                            Numéro
                                        </label>
                                        <input type="text" id="number" name="number" class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm
                             focus:ring-slate-500 focus:border-slate-700 sm:text-sm" value="{{old('number') || '' }}">
                                        @inputError('number')
                                        <div style="color: red;">{{ $messages.join(', ') }}</div>
                                        @end
                                    </div>
                                </div>

                                <div class="flex mb-3 gap-2">
                                    <div class="flex flex-col w-2/6">
                                        <label for="zip_code" class="block text-gray-600">
                                            Code Postal
                                        </label>
                                        <input type="text" id="zip_code" name="zip_code" class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm
                             focus:ring-slate-500 focus:border-slate-700 sm:text-sm"
                                            value="{{old('zip_code') || '' }}">
                                        @inputError('zip_code')
                                        <div style="color: red;">{{ $messages.join(', ') }}</div>
                                        @end
                                    </div>

                                    <div class="flex flex-col">
                                        <label for="city" class="block text-gray-600">
                                            Ville
                                        </label>
                                        <input type="text" id="city" name="city" class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm
                             focus:ring-slate-500 focus:border-slate-700 sm:text-sm" value="{{old('city') || '' }}">
                                        @inputError('city')
                                        <div style="color: red;">{{ $messages.join(', ') }}</div>
                                        @end
                                    </div>

                                    <div class="flex flex-col mb-3">
                                        <label for="country" class="block text-gray-600">
                                            Pays
                                        </label>
                                        <input type="text" id="country" name="country" value="Belgique" class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm
                             focus:ring-slate-500 focus:border-slate-700 sm:text-sm" value="{{old('country') || '' }}">
                                        @inputError('country')
                                        <div style="color: red;">{{ $messages.join(', ') }}</div>
                                        @end
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section class="p-10 bg-emerald-700 rounded-lg flex flex-col items-center">
                        <label for="images_link" class="text-center text-white">
                            Charger des images (max. 3)
                        </label>
                        <input class="mt-4 max-w-56 text-white" type="file" id="images_link" name="images_link[]"
                            onchange="previewImages()" accept="image/png, image/gif, image/jpeg" multiple />
                        @inputError('images_link')
                        <div style="color: red;">{{ $messages.join(', ') }}</div>
                        @end
                        <div id="imagePreviewContainer" class="flex flex-wrap mt-4"></div>
                    </section>

                    <div class="flex w-full p-3 bg-lime-50 rounded-lg">
                        <fieldset class="py-2 w-1/2">
                            <legend class="block text-gray-600">Catégories:</legend>
                            @each(category in categories)
                            <ul>
                                <li>
                                    {{-- TODO change to radio button --}}
                                    <input type="radio" id="category_{{ category.id }}" name="categories[]"
                                        value="{{ category.id }}" onchange="toggleCategoryTypes({{ category.id }})" />
                                    <label for="category_{{ category.id }}">{{ category.name }}</label>

                                    <fieldset id="categoryTypesFieldset_{{ category.id }}" name="categoryTypesFieldset"
                                        class="hidden relative left-10">
                                        @each(categoryType in categoryTypes)

                                            @if (categoryType.categoryId == category.id)
                                                <li class="category-type category-type-{{ categoryType.categoryId }} ">
                                                    <input type="checkbox" id="categoryType_{{ categoryType.id }}"
                                                        name="categoryTypes[]" value="{{ categoryType.id }}" />
                                                    <label for="categoryType_{{ categoryType.id }}">{{ categoryType.name }}</label>
                                                </li>
                                            @endif
                                        @end
                                    </fieldset>


                                </li>

                        @end
                        </fieldset>

                        <fieldset class="py-2 w-1/2">
                            <legend class="block text-gray-600">Indicateurs:</legend>
                            @each(indicator in indicators)
                            <ul>
                                <li>
                                    <input type="checkbox" id="indicator_{{ indicator.id }}" name="indicators[]"
                                        value="{{ indicator.id }}" />
                                    <label for="indicator_{{ indicator.id }}">{{ indicator.name }}</label>
                                </li>
                            </ul>
                            @end
                        </fieldset>
                    </div>

                    <div class="text-sm">
                        <div class="pb-3">
                            <label for="facebook_link" class="block text-gray-600">
                                Lien Facebook
                            </label>
                            <input type="text" id="facebook_link" name="facebook_link" class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm
               focus:ring-slate-500 focus:border-slate-700 sm:text-sm" value="{{old('facebook_link') || '' }}">
                        </div>

                        <div class="pb-3">
                            <label for="instagram_link" class="block text-gray-600">
                                Lien Instagram
                            </label>
                            <input type="text" id="instagram_link" name="instagram_link" class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm
               focus:ring-slate-500 focus:border-slate-700 sm:text-sm" value="{{old('instagram_link') || '' }}">
                        </div>

                        <div class="pb-3">
                            <label for="website_link" class="block text-gray-600">
                                Site Web
                            </label>
                            <input type="text" id="website_link" name="website_link" class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm
               focus:ring-slate-500 focus:border-slate-700 sm:text-sm" value="{{old('website_link') || '' }}">
                        </div>

                        <div class="pb-3">
                            <label for="youtube_link" class="block text-gray-600">
                                Lien vidéo YouTube
                            </label>
                            <input type="text" id="youtube_link" name="youtube_link" class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm
             focus:ring-slate-500 focus:border-slate-700 sm:text-sm" value="{{old('youtube_link') || '' }}">
                        </div>
                    </div>


                    <div class="text-sm p-3 bg-fuchsia-50 rounded-lg">
                        @!component('components/price_fields')

                        <template id="priceFieldsTemplate">
                            @!component('components/price_fields')
                        </template>
                        <div id="priceFieldsContainer" class="flex flex-col gap-4">
                            <!-- div to add the addionnal prices -->
                        </div>
                    </div>

                    <button type="button" onclick="addPriceFields()" class="bg-blue-700 text-white py-2 px-4 rounded-md hover:bg-blue-500 
                focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500">
                        Ajouter des tarifs
                    </button>

                    <div>
                        <input type="checkbox" id="displayDiscountSection" name="" value=""
                            onchange="toggleDiscountedPriceSection(this)" />
                        <label for="displayDiscountSection">Voulez vous ajouter des prix réduits</label>
                    </div>

                    <div class="bg-orange-200 p-5 rounded-md hidden" id="discountedPriceSection">
                        @!component('components/discounted_price_fields')

                        <template id="discountedPriceFieldsTemplate">
                            @!component('components/discounted_price_fields')
                        </template>
                        <div id="discountedPriceFieldsContainer" class="flex flex-col gap-4">
                            <!-- div to add the addionnal prices -->
                        </div>

                        <button type="button" onclick="addDiscountedPriceFields()" class=" mt-4 bg-orange-700 text-white py-2 px-4 rounded-md hover:bg-orange-900 
                    focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500">
                            Ajouter des tarifs réduits
                        </button>
                    </div>

                    <div>

                        <button type="submit" class="w-full bg-gray-800 text-white py-2 px-4 rounded-md hover:bg-gray-700 
          focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500">
                            Créer
                        </button>
                    </div>

                </form>

            </div>
    </section>

    @include("pages/partials/footer")
    <script src="/resources/js/add_event.js"></script>
</body>

</html>